"use strict";

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

/**
 * Created by Administrator on 2016/11/16.
 *
 * 最顶层的页面需要有sdwShareState对象
 *
 */var sdw;window.NativeBridge;var OS = {},
    u = navigator.userAgent;OS.onIOS = !!u.match(/\(i[^;]+;(U;)? CPU.+Mac OS X/);OS.onMobile = !!u.match(/AppleWebKit.*Mobile.*/);OS.onIPhone = -1 < u.indexOf("iPhone");OS.onIPad = -1 < u.indexOf("iPad");OS.onAndriod = -1 < u.indexOf("Android") || -1 < u.indexOf("Adr");OS.onWP = -1 < u.indexOf("Windows Phone");OS.onQQBrowser = -1 < u.indexOf("QQBrowser");OS.onMQQBrowser = -1 < u.indexOf("MQQBrowser");OS.onWeiXin = -1 < u.indexOf("MicroMessenger");OS.onWeiBo = -1 < u.indexOf("Weibo");OS.onSafari = -1 < u.indexOf("Safari");OS.onQQ = OS.onIOS ? -1 < u.indexOf("QQ") : OS.onMQQBrowser && !OS.onWeiXin;OS.onPC = !OS.onMobile;OS.onKD = /KDM3G/.test(u) || /KDM3GNEW/.test(u) || "undefined" != typeof kdjs || "undefined" != typeof callKDMSGToResponse;OS.width = document.documentElement.clientWidth || document.body.clientWidth;OS.height = document.documentElement.clientHeight || document.body.clientHeight;OS.onShandw = /Shandw/.test(navigator.userAgent);OS.onAPPs = OS.onMobile && (OS.onWeiXin || OS.onQQ || OS.onKD || OS.onShandw || OS.onWeiBo);OS.ky = window !== parent;OS.os = 0;OS.onIOS ? OS.os = 2 : OS.onAndriod && (OS.os = 1);OS.getNow = function () {
  return +new Date();
};var APP = OS;APP.onKD && APP.onAndriod && (APP.and_KdVer = parseInt(kdjs.getKDVersion().replace(/\D/g, "")));NativeBridge = { name: "sdwJs", loadJs: 1, callbacksCount: 1, callbacks: { goBackstage: null, recoverBackstage: null, pullDownRefresh: function pullDownRefresh() {} }, resultForCallback: function resultForCallback(a, c) {
    var d = NativeBridge.callbacks[a];d ? d(c) : setTimeout(function () {}, 10);
  }, objectToString: function objectToString(a) {
    var c = {},
        d;for (d in a) {
      c[d] = "function" == typeof a[d] ? a[d].toString() : a[d];
    }return JSON.stringify(c);
  }, call: function call(a, c, d, b) {
    var l = d && "function" == typeof d,
        m = l ? NativeBridge.callbacksCount++ : -1,
        n = !1;APP.ky && l && "quickPayment" != a && (b = JSON.stringify({ optionStr: this.objectToString(b), functionName: a, callbackId: m, args: c, postSdwData: !0, operate: "createNativeBridgeCallback" }), window.parent.postMessage(b, "*"), n = !0);l && (sessionStorage["NativeBridge_callbacks" + m] = d.toString(), NativeBridge.callbacks[m] = d);n || (c = JSON.stringify({ callbackId: m, args: c }), a = ("quickPayment" == a ? "payment://" : "sdw://") + (a + "#" + c), console.log(a), c = document.createElement("IFRAME"), c.src = a, document.documentElement.appendChild(c), c.parentNode.removeChild(c));
  } };var __sdw__ = { _shareItems: ["QQ", "Timeline", "AppMessage", "Weibo", "QZone"], _otherItems: ["copyLink", "followWeixin", "addDesktop", "customService"], _toolBarItems: "QQ Timeline AppMessage Weibo QZone copyLink followWeixin addDesktop customService".split(" "), checkShareItem: function checkShareItem(a) {
    for (var c = __sdw__._toolBarItems.slice(0), d = 0; d < c.length; d++) {
      if (c[d] == a) return !0;
    }return !1;
  } };window.sdw = { cachePayHandler: null, JsApiTicket: "", debug: 1, loadJs: 1, pre_callbacks: [], onShandw: /Shandw/.test(navigator.userAgent), customToolBarItems: [], init_load: function init_load() {
    var a = this,
        c = document.createElement("script");c.src = "";document.getElementsByTagName("head")[0].appendChild(c);c.onload = function () {
      a.loadJs = 1;if (a.pre_callbacks.length) for (var c = 0; c < a.pre_callbacks.length; c++) {
        var b = a.pre_callbacks[c];b.cb(b.args);
      }
    };
  }, log: function log(a) {
    this.debug && alert(a);
  }, hasSDK: function hasSDK() {
    var a = /WangZuo/.test(navigator.userAgent),
        c = "undefined" != typeof CDLAndroid,
        d = /KDM3GNEW/.test(navigator.userAgent);return c || d || a;
  }, selectImg: function selectImg() {
    var a = document.getElementsByTagName("img");return a ? a[0].src : "";
  }, createCallback: function createCallback(a) {
    var c = this;return function (d) {
      try {
        var b = JSON.parse(d);0 == b.result ? a.fail && a.fail(b) : 1 == b.result ? a.success && a.success(b) : 2 == b.result && a.cancel && a.cancel(b);
      } catch (l) {
        c.log(l);
      }
    };
  }, createSDKCallback: function createSDKCallback(a) {
    var c = this;return function (d) {
      var b = c.createPayData(a);a.complete && setTimeout(function () {
        a.complete(b);
      }, 20);
    };
  }, createPayData: function createPayData(a) {
    var c = {};c.channel = a.channel;c.appId = a.appId;c.cpOrderId = a.cpOrderId;c.timestamp = a.timestamp;c.accountId = a.accountId;c.amount = a.amount;c.memo = a.memo;return c;
  }, checkOptionCallback: function checkOptionCallback(a) {
    for (var c = !0, d = ["success", "fail", "cancel", "complete"], b = 0; b < d.length; b++) {
      a[d[b]] && (c = c && "function" == typeof a[d[b]]);
    }c || this.log("Function\u7C7B\u578B\u9519\u8BEF");return c;
  }, checkOptionArguments: function checkOptionArguments(a, c) {
    for (var d = 0; d < c.length; d++) {
      if (!a.hasOwnProperty(c[d])) return { result: 0, msg: "\u53C2\u6570" + c[d] + "\u6709\u8BEF" };
    }return { result: 1 };
  }, __sortToolBars: function __sortToolBars(a) {
    for (var c = { firstLine: [], secondLine: [] }, d = 0; d < a.length; d++) {
      for (var b = 0; b < __sdw__._shareItems.length; b++) {
        if (a[d] == __sdw__._shareItems[b]) {
          c.firstLine.push(a[d]);break;
        }
      }
    }for (d = 0; d < a.length; d++) {
      for (b = 0; b < __sdw__._otherItems.length; b++) {
        if (a[d] == __sdw__._otherItems[b]) {
          c.secondLine.push(a[d]);break;
        }
      }
    }return c;
  }, checkWebJsFile: function checkWebJsFile() {
    if ("undefined" != typeof dhpayObj) return !0;this.log("\u8BF7\u68C0\u67E5\u662F\u5426\u5F15\u5165\u652F\u4ED8\u6587\u4EF6");return !1;
  }, chooseSDWPay: function chooseSDWPay(a) {
    if ("string" == typeof a) try {
      a = JSON.parse(a);
    } catch (f) {}a = a || {};var c = this.checkOptionArguments(a, "subject appId gameName accountId amount memo cpOrderId sign timestamp channel".split(" "));a.paychannel = a.paychannel || "";if (0 == c.result) this.log(c.msg);else if (this.checkOptionCallback(a)) {
      var c = window.sdw.getUrlObj(),
          d = c._sdw_platform_pay_;if (c._sdw_platform_ && d && "undefined" != typeof window._sdw_3th_pay_fun) window._sdw_3th_pay_fun(a);else {
        if (this.onShandw || this.hasSDK()) {
          var b = this.createSDKCallback(a);/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent) ? this.cachePayHandler = function () {
            NativeBridge.call("quickPayment", JSON.stringify(a), b, a);
          } : this.cachePayHandler = function () {
            CDLAndroid.quickPayment(JSON.stringify(a));window.onDHSDKResult = b;
          };
        } else {
          var l = { postjson: {}, resultpost: !0, config: { alipay: !0, weixin: !0 } },
              m;for (m in a) {
            if ("success" != m && "fail" != m && "cancel" != m && "complete" != m && "paychannel" != m && (l.postjson[m] = a[m]), "complete" == m && "function" == typeof a.complete) {
              var n = this.createPayData(a);l.closecallback = function () {
                a.complete(n);
              };
            }
          }l.closecallback || (l.closecallback = function () {});"" != a.paychannel && (m = "weixin" == a.paychannel, l.config.alipay = !m, l.config.weixin = m);APP.onKD && APP.onAndriod && 402 > APP.and_KdVer && (l.config.alipay = !1);this.cachePayHandler = function () {
            dhpayObj && dhpayObj.payfor(l);
          };
        }APP.ky ? /(?=.*btnName)(?=.*M32GW)^.*$/.test(location.href) ? this.cachePayHandler && this.cachePayHandler() : window.parent.postMessage(JSON.stringify({ postSdwData: !0, operate: "checkVisitorMode" }), "*") : this.cachePayHandler && this.cachePayHandler();
      }
    }
  }, onSetShareOperate: function onSetShareOperate(a) {
    a = this.clone(a);"function" != typeof a.success && (a.success = function () {});"function" != typeof a.cancel && (a.cancel = function () {});"function" != typeof a.fail && (a.fail = function () {});var c = { postSdwData: !0, operate: "setSDWShareInfo" };c.shareInfo = a;if (APP.onWeiXin) {
      var d = __sdw__._shareItems.slice(0);c.source = "weixin";if ("undefined" == typeof a.target || "" == a.target) a.target = d;else {
        for (var b = a.target, l = [], m = 0; m < b.length; m++) {
          -1 != d.indexOf(b[m]) && l.push(b[m]);
        }a.target = l;
      }
    }APP.ky ? (window.sdw.childSuccessCallback = a.success, window.sdw.childCancelCallback = a.cancel, window.sdw.childFailCallback = a.fail, parent.postMessage(JSON.stringify(c), "*")) : alert("\u5206\u4EAB\u63A5\u53E3\u53EA\u5141\u8BB8\u5728iframe\u4E2D\u8BBE\u7F6E\u54E6~");
  }, closeSDWPay: function closeSDWPay() {
    this.onShandw || this.hasSDK() || (APP.ky && APP.onWeiXin ? window.parent.postMessage(JSON.stringify({ operate: "requestHideQrcode" }), "*") : dhpayObj && dhpayObj.hidepay());
  }, setLocalStorage: function setLocalStorage(a, c) {
    APP.onIOS && APP.onKD && APP.ky ? window.parent.postMessage(JSON.stringify({ postSdwData: !0, operate: "sdw_setLocalStorage", key: a, data: c }), "*") : localStorage["_SDW_" + a] = JSON.stringify({ name: "sdw_data", data: c });
  }, readLocalStorage: function readLocalStorage(a, c) {
    if (APP.onIOS && APP.onKD && APP.ky) sdw._readLocalStorageCallback = c, window.parent.postMessage(JSON.stringify({ postSdwData: !0, key: a, operate: "sdw_getLocalStorage" }), "*");else {
      var d = localStorage["_SDW_" + a];try {
        d = JSON.parse(d), c(d.data);
      } catch (b) {
        c(null);
      }
    }
  }, postServerId: function postServerId(a) {
    "undefined" == typeof a.time && (a.time = +new Date() / 1E3 >> 0);if ("1414483796" == a.appid) {
      var c = "" + a.channel + a.appid + a.uid + a.time + a.subject + "ad8be929a4be929227e72772a05695de";a.sign = sdw._MD5(c);console.log(c);console.log(a.sign);
    }sdw.getAjaxData("https://auth.shandw.com/wzupsid?channel\x3d" + a.channel + "\x26appid\x3d" + a.appid + "\x26uid\x3d" + a.uid + "\x26time\x3d" + a.time + "\x26subject\x3d" + a.subject + "\x26sign\x3d" + a.sign, function (c) {
      a.complete && a.complete(c);
    });
  }, clone: function clone(a) {
    if ("object" == (typeof a === "undefined" ? "undefined" : _typeof(a))) {
      var c = {},
          d;for (d in a) {
        c[d] = a[d];
      }
    }return c;
  } };APP.ky && window.addEventListener("message", function (a) {
  try {
    var c = JSON.parse(a.data);if (c.postSdwData) {
      var d = c.oprate;"shareCallback_success" == d && window.sdw.childSuccessCallback && window.sdw.childSuccessCallback();"shareCallback_cancel" == d && window.sdw.childFailCallback && window.sdw.childCancelCallback();"shareCallback_fail" == d && window.sdw.childFailCallback && window.sdw.childFailCallback();"choosePayCheckState_ok" == d && sdw.cachePayHandler && sdw.cachePayHandler();if ("getLocalStorage_ok" == d) {
        var b = c.data;sdw._readLocalStorageCallback && sdw._readLocalStorageCallback(b);
      }
    }
  } catch (l) {
    console.log(l);
  }
}, !1);window.sdw._MD5 = function (a) {
  function c(a) {
    for (var b = [], c = 0; c < a.length; c++) {
      b = b.concat(l(a[c]));
    }return b;
  }function d(a) {
    for (var b = [], c = 0; 8 > c; c++) {
      b.push(a & 255), a >>>= 8;
    }return b;
  }function b(a, b) {
    return a[b + 3] << 24 | a[b + 2] << 16 | a[b + 1] << 8 | a[b];
  }function l(a) {
    for (var b = [], c = 0; c < a.length; c++) {
      if (127 >= a.charCodeAt(c)) b.push(a.charCodeAt(c));else for (var f = encodeURIComponent(a.charAt(c)).substr(1).split("%"), d = 0; d < f.length; d++) {
        b.push(parseInt(f[d], 16));
      }
    }return b;
  }function m(a, b, c, f) {
    for (var d = "", p, l, e = 3; 0 <= e; e--) {
      l = arguments[e], p = l & 255, l >>>= 8, p <<= 8, p |= l & 255, l >>>= 8, p <<= 8, p |= l & 255, l >>>= 8, p <<= 8, p |= l, p = (p >>> 0).toString(16), p = "00000000".substr(0, 8 - p.length) + p, d += p;
    }return d;
  }function n(a) {
    for (var b = Array(a.length), c = 0; c < a.length; c++) {
      b[c] = a[c];
    }return b;
  }var f = null,
      q = null;"string" == typeof a ? f = l(a) : a.constructor == Array ? 0 === a.length ? f = a : "string" == typeof a[0] ? f = c(a) : "number" == typeof a[0] ? f = a : q = _typeof(a[0]) : "undefined" != typeof ArrayBuffer ? a instanceof ArrayBuffer ? f = n(new Uint8Array(a)) : a instanceof Uint8Array || a instanceof Int8Array ? f = n(a) : a instanceof Uint32Array || a instanceof Int32Array || a instanceof Uint16Array || a instanceof Int16Array || a instanceof Float32Array || a instanceof Float64Array ? f = n(new Uint8Array(a.buffer)) : q = typeof a === "undefined" ? "undefined" : _typeof(a) : q = typeof a === "undefined" ? "undefined" : _typeof(a);q && alert("MD5 type mismatch, cannot process " + q);return function () {
    function a(a, b, c, d) {
      var f = g;g = h;var k = h = e;a = 4294967295 & t + (4294967295 & a + (4294967295 & b + c));e = 4294967295 & k + (a << d & 4294967295 | a >>> 32 - d);t = f;
    }var c = f.length;f.push(128);var l = f.length % 64;if (56 < l) {
      for (var n = 0; n < 64 - l; n++) {
        f.push(0);
      }l = f.length % 64;
    }for (n = 0; n < 56 - l; n++) {
      f.push(0);
    }f = f.concat(d(8 * c));for (var c = 1732584193, l = 4023233417, q = 2562383102, r = 271733878, t = 0, e = 0, h = 0, g = 0, n = 0; n < f.length / 64; n++) {
      var t = c,
          e = l,
          h = q,
          g = r,
          k = 64 * n;a(e & h | ~e & g, 3614090360, b(f, k), 7);a(e & h | ~e & g, 3905402710, b(f, k + 4), 12);a(e & h | ~e & g, 606105819, b(f, k + 8), 17);a(e & h | ~e & g, 3250441966, b(f, k + 12), 22);a(e & h | ~e & g, 4118548399, b(f, k + 16), 7);a(e & h | ~e & g, 1200080426, b(f, k + 20), 12);a(e & h | ~e & g, 2821735955, b(f, k + 24), 17);a(e & h | ~e & g, 4249261313, b(f, k + 28), 22);a(e & h | ~e & g, 1770035416, b(f, k + 32), 7);a(e & h | ~e & g, 2336552879, b(f, k + 36), 12);a(e & h | ~e & g, 4294925233, b(f, k + 40), 17);a(e & h | ~e & g, 2304563134, b(f, k + 44), 22);a(e & h | ~e & g, 1804603682, b(f, k + 48), 7);a(e & h | ~e & g, 4254626195, b(f, k + 52), 12);a(e & h | ~e & g, 2792965006, b(f, k + 56), 17);a(e & h | ~e & g, 1236535329, b(f, k + 60), 22);a(g & e | ~g & h, 4129170786, b(f, k + 4), 5);a(g & e | ~g & h, 3225465664, b(f, k + 24), 9);a(g & e | ~g & h, 643717713, b(f, k + 44), 14);a(g & e | ~g & h, 3921069994, b(f, k), 20);a(g & e | ~g & h, 3593408605, b(f, k + 20), 5);a(g & e | ~g & h, 38016083, b(f, k + 40), 9);a(g & e | ~g & h, 3634488961, b(f, k + 60), 14);a(g & e | ~g & h, 3889429448, b(f, k + 16), 20);a(g & e | ~g & h, 568446438, b(f, k + 36), 5);a(g & e | ~g & h, 3275163606, b(f, k + 56), 9);a(g & e | ~g & h, 4107603335, b(f, k + 12), 14);a(g & e | ~g & h, 1163531501, b(f, k + 32), 20);a(g & e | ~g & h, 2850285829, b(f, k + 52), 5);a(g & e | ~g & h, 4243563512, b(f, k + 8), 9);a(g & e | ~g & h, 1735328473, b(f, k + 28), 14);a(g & e | ~g & h, 2368359562, b(f, k + 48), 20);a(e ^ h ^ g, 4294588738, b(f, k + 20), 4);a(e ^ h ^ g, 2272392833, b(f, k + 32), 11);a(e ^ h ^ g, 1839030562, b(f, k + 44), 16);a(e ^ h ^ g, 4259657740, b(f, k + 56), 23);a(e ^ h ^ g, 2763975236, b(f, k + 4), 4);a(e ^ h ^ g, 1272893353, b(f, k + 16), 11);a(e ^ h ^ g, 4139469664, b(f, k + 28), 16);a(e ^ h ^ g, 3200236656, b(f, k + 40), 23);a(e ^ h ^ g, 681279174, b(f, k + 52), 4);a(e ^ h ^ g, 3936430074, b(f, k), 11);a(e ^ h ^ g, 3572445317, b(f, k + 12), 16);a(e ^ h ^ g, 76029189, b(f, k + 24), 23);a(e ^ h ^ g, 3654602809, b(f, k + 36), 4);a(e ^ h ^ g, 3873151461, b(f, k + 48), 11);a(e ^ h ^ g, 530742520, b(f, k + 60), 16);a(e ^ h ^ g, 3299628645, b(f, k + 8), 23);a(h ^ (e | ~g), 4096336452, b(f, k), 6);a(h ^ (e | ~g), 1126891415, b(f, k + 28), 10);a(h ^ (e | ~g), 2878612391, b(f, k + 56), 15);a(h ^ (e | ~g), 4237533241, b(f, k + 20), 21);a(h ^ (e | ~g), 1700485571, b(f, k + 48), 6);a(h ^ (e | ~g), 2399980690, b(f, k + 12), 10);a(h ^ (e | ~g), 4293915773, b(f, k + 40), 15);a(h ^ (e | ~g), 2240044497, b(f, k + 4), 21);a(h ^ (e | ~g), 1873313359, b(f, k + 32), 6);a(h ^ (e | ~g), 4264355552, b(f, k + 60), 10);a(h ^ (e | ~g), 2734768916, b(f, k + 24), 15);a(h ^ (e | ~g), 1309151649, b(f, k + 52), 21);a(h ^ (e | ~g), 4149444226, b(f, k + 16), 6);a(h ^ (e | ~g), 3174756917, b(f, k + 44), 10);a(h ^ (e | ~g), 718787259, b(f, k + 8), 15);a(h ^ (e | ~g), 3951481745, b(f, k + 36), 21);c = 4294967295 & c + t;l = 4294967295 & l + e;q = 4294967295 & q + h;r = 4294967295 & r + g;
    }return m(r, q, l, c).toUpperCase();
  }();
};window.sdw.getAjaxData = function (a, c) {
  if (a) {
    var d = function () {
      var a;if (window.XMLHttpRequest) a = new XMLHttpRequest(), a.overrideMimeType && a.overrideMimeType("text/xml");else if (window.ActiveXObject) for (var c = ["MSXML2.XMLHTTP", "Microsoft.XMLHTTP"], d = 0; d < c.length; d++) {
        try {
          a = new ActiveXObject(c[d]);break;
        } catch (n) {}
      }return a;
    }();d && (d.open("GET", a, !0), d.onreadystatechange = function () {
      if (4 == d.readyState && 200 == d.status) {
        var a = JSON.parse(d.responseText);c && c(a);
      } else console.log("[AJAX ERROR]:", d);
    }, d.send(null));
  } else console.log("[getAjaxData]: url error");
};window.sdw.getUrlObj = function () {
  for (var a = 0 < location.search.length ? location.search.substring(1) : "", c = {}, a = a.length ? a.split("\x26") : [], d, b, l = 0; l < a.length; l++) {
    d = a[l].split("\x3d"), b = decodeURIComponent(d[0]), d = decodeURIComponent(d[1]), b.length && (c[b] = d);
  }return c;
};window.sdw.addJsFile = function (a, c) {
  var d = document.getElementsByTagName("HEAD").item(0),
      b = document.createElement("script");b.type = "text/javascript";b.src = a;d.appendChild(b);b.onload = c;
};(function () {
  var a = window.sdw.getUrlObj(),
      c = a._sdw_platform_,
      a = a._sdw_platform_pay_;c && a && window.sdw.addJsFile("https://www.shandw.com/3th/" + c + "/pay.min.js");
})();
/*# sourceMappingURL=sdwJs.min.js.map */